{"version":3,"file":"user.bundle.js","mappings":"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","sources":["webpack://yakuza-kareoke/./src/config.js","webpack://yakuza-kareoke/./src/api/main.js","webpack://yakuza-kareoke/./src/utility.js/responseText.js","webpack://yakuza-kareoke/./src/admin/users.js","webpack://yakuza-kareoke/./src/api/admin.js"],"sourcesContent":["const config = {\r\n  dealy: 3,\r\n  timingWindowEarly: 0.2,\r\n  timingWindowLate: 0.1,\r\n  pointWidth: 10,\r\n  pointSpacing: 10,\r\n  startTime: 3,\r\n  apiDomain: {\r\n    development: \"http://localhost:5000\",\r\n    production: \"https://shark-app-uuvcm.ondigitalocean.app/\",\r\n  },\r\n  // for fetch requests\r\n};\r\n\r\nexport default config;\r\n","import config from \"../config\";\r\nimport responseText from \"../utility.js/responseText\";\r\n\r\nconst { apiDomain } = config;\r\n\r\nexport default async function apiRequest({ url, options, headers = {} }) {\r\n  const location = [\"localhost\", \"127.0.0.1\"].includes(window.location.hostname)\r\n    ? apiDomain.development\r\n    : apiDomain.production;\r\n  const response = await fetch(`${location}/${url}`, {\r\n    mode: \"cors\",\r\n    credentials: \"include\",\r\n    headers: {\r\n      CSRF_TOKEN: sessionStorage.getItem(\"csrfToken\"),\r\n      ...headers,\r\n    },\r\n    ...options,\r\n  });\r\n\r\n  if (response.ok === false) {\r\n    const message = await response.text();\r\n    throw new Error(responseText(message));\r\n  }\r\n\r\n  if (response.status === 401) {\r\n    // delete session data and storage, and logout from front end\r\n  }\r\n  return response;\r\n}\r\n","// gets the response text from an http error\r\n\r\nexport default function responseText(html) {\r\n  const container = document.createElement(\"div\");\r\n  container.innerHTML = html;\r\n  const text =\r\n    container.querySelector(\"p\")?.textContent ||\r\n    \"error could not compelte request\";\r\n  return text;\r\n}\r\n","import { getUsers, ban, unban } from \"../api/admin\";\r\n\r\nconst banUser = (id, listItem, button, reason) => {\r\n  // eslint-disable-next-line no-restricted-globals\r\n  const accept = confirm(\"are you sure you want to ban this user?\");\r\n  if (!accept) return;\r\n  // eslint-disable-next-line no-param-reassign\r\n  button.textContent = \"...\";\r\n  ban(id, reason)\r\n    .then((res) => {\r\n      console.log(res);\r\n\r\n      listItem.remove();\r\n    })\r\n    .catch((err) => {\r\n      console.log(err);\r\n      // eslint-disable-next-line no-param-reassign\r\n      button.textContent = \"ban\";\r\n    });\r\n};\r\n\r\nconst unbanUser = (id, listItem, button) => {\r\n  // eslint-disable-next-line no-restricted-globals\r\n  const accept = confirm(\"are you sure you want to unban this user?\");\r\n  if (!accept) return;\r\n  // eslint-disable-next-line no-param-reassign\r\n  button.textContent = \"...\";\r\n  unban(id)\r\n    .then((res) => {\r\n      console.log(res);\r\n\r\n      listItem.remove();\r\n    })\r\n    .catch((err) => {\r\n      console.log(err);\r\n      // eslint-disable-next-line no-param-reassign\r\n      button.textContent = \"unban\";\r\n    });\r\n};\r\nconst generateListItem = (user) => {\r\n  const listItem = document.createElement(\"li\");\r\n  const name = document.createElement(\"span\");\r\n  name.textContent = `${user.username} (${user.id})`;\r\n  listItem.append(name);\r\n  const reason = document.createElement(\"p\");\r\n  listItem.append(reason);\r\n  reason.textContent = user.banned ? `reason: ${user.banned}` : \"\";\r\n  const button = document.createElement(\"button\");\r\n\r\n  listItem.append(button);\r\n  return { listItem, button };\r\n};\r\n\r\ngetUsers().then((res) => {\r\n  const banned = res.filter((user) => user.banned);\r\n  const users = res.filter((user) => !user.banned);\r\n  const userList = document.querySelector(\"#users\");\r\n  const banList = document.querySelector(\"#ban\");\r\n  users.forEach((user) => {\r\n    const { listItem, button } = generateListItem(user);\r\n    button.textContent = \"ban\";\r\n    const textBox = document.createElement(\"input\");\r\n    listItem.append(textBox);\r\n\r\n    button.addEventListener(\"click\", () => {\r\n      if (textBox.value === \"\") {\r\n        console.log(\"need a reason prior to banning\");\r\n        return;\r\n      }\r\n      banUser(user.id, listItem, button, textBox.value);\r\n    });\r\n    userList.append(listItem);\r\n  });\r\n  banned.forEach((user) => {\r\n    const { listItem, button } = generateListItem(user);\r\n    button.textContent = \"unban\";\r\n    button.addEventListener(\"click\", () =>\r\n      unbanUser(user.id, listItem, button)\r\n    );\r\n    banList.append(listItem);\r\n  });\r\n});\r\n","import apiRequest from \"./main\";\r\n\r\nexport async function publishMap(beatMapID, resolution) {\r\n  const options = {\r\n    method: \"post\",\r\n    body: JSON.stringify({ beatMapID, resolution }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `kareoke/publish_map`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function deleteMapAdmin(id) {\r\n  const options = {\r\n    method: \"delete\",\r\n    body: JSON.stringify({ id }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `kareoke/delete_map_admin`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function getUsers() {\r\n  const options = {\r\n    method: \"get\",\r\n  };\r\n  const response = await apiRequest({\r\n    url: `auth/get_users`,\r\n    options,\r\n  });\r\n  const data = await response.json();\r\n  return data;\r\n}\r\n\r\nexport async function ban(user, reason) {\r\n  const options = {\r\n    method: \"post\",\r\n    body: JSON.stringify({ user, reason }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `auth/ban`,\r\n    options,\r\n    headers,\r\n  });\r\n  const data = await response.text();\r\n  return data;\r\n}\r\n\r\nexport async function unban(user) {\r\n  const options = {\r\n    method: \"post\",\r\n    body: JSON.stringify({ user }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `auth/unban`,\r\n    options,\r\n    headers,\r\n  });\r\n  const data = await response.text();\r\n  return data;\r\n}\r\n"],"names":["apiDomain","dealy","timingWindowEarly","timingWindowLate","pointWidth","pointSpacing","startTime","development","production","async","url","options","headers","location","includes","window","hostname","response","fetch","mode","credentials","CSRF_TOKEN","sessionStorage","getItem","ok","message","text","Error","html","container","document","createElement","innerHTML","querySelector","textContent","responseText","status","generateListItem","user","listItem","name","username","id","append","reason","banned","button","method","json","getUsers","then","res","filter","users","userList","banList","forEach","textBox","addEventListener","value","confirm","body","JSON","stringify","ban","console","log","remove","catch","err","banUser","unban","unbanUser"],"sourceRoot":""}