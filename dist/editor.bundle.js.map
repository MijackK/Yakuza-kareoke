{"version":3,"file":"editor.bundle.js","mappings":"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","sources":["webpack://yakuza-kareoke/webpack/bootstrap","webpack://yakuza-kareoke/webpack/runtime/global","webpack://yakuza-kareoke/webpack/runtime/publicPath","webpack://yakuza-kareoke/./src/canvas/canvas.js","webpack://yakuza-kareoke/./src/canvas/time-map.js","webpack://yakuza-kareoke/./src/utility.js/storage.js","webpack://yakuza-kareoke/./src/player-parts/display-parts.js","webpack://yakuza-kareoke/./src/dom-manipulation/editor-dom.js","webpack://yakuza-kareoke/./src/config.js","webpack://yakuza-kareoke/./src/api/main.js","webpack://yakuza-kareoke/./src/utility.js/responseText.js","webpack://yakuza-kareoke/./src/api/kareoke.js","webpack://yakuza-kareoke/./src/editor/editor.js","webpack://yakuza-kareoke/./src/managers/editor_manager.js","webpack://yakuza-kareoke/./src/managers/map_manager.js","webpack://yakuza-kareoke/./src/managers/user-manager.js","webpack://yakuza-kareoke/./src/api/authentication.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && !scriptUrl) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","import holdText from \"../images/hold.png\";\r\nimport rapidText from \"../images/rapid.png\";\r\nimport upImg from \"../images/up.png\";\r\nimport leftImg from \"../images/left.png\";\r\nimport downImg from \"../images/down.png\";\r\nimport rightImg from \"../images/right.png\";\r\n\r\nconst entryOffset = 3.0; // determines the speed of prompt\r\nconst widthPerSecond = Number(((1897.5 - 400) / entryOffset).toFixed(3));\r\nlet key;\r\n\r\nconst symbols = {\r\n  ArrowUp: document.createElement(\"img\"),\r\n  ArrowLeft: document.createElement(\"img\"),\r\n  ArrowRight: document.createElement(\"img\"),\r\n  ArrowDown: document.createElement(\"img\"),\r\n};\r\nconst yPosition = {\r\n  ArrowUp: 30,\r\n  ArrowRight: 83,\r\n  ArrowLeft: 130,\r\n  ArrowDown: 185,\r\n};\r\nsymbols.ArrowUp.src = upImg;\r\nsymbols.ArrowLeft.src = leftImg;\r\nsymbols.ArrowDown.src = downImg;\r\nsymbols.ArrowRight.src = rightImg;\r\nlet ctx;\r\nlet myCanvas;\r\nconst textImage = document.createElement(\"img\");\r\nconst longPromptText = {\r\n  rapid: rapidText,\r\n  hold: holdText,\r\n};\r\n\r\nexport const init = () => {\r\n  myCanvas = document.querySelector(\".cplayer\");\r\n  myCanvas.width = window.innerWidth;\r\n  myCanvas.height = 215;\r\n\r\n  if (myCanvas.getContext) {\r\n    ctx = myCanvas.getContext(\"2d\"); // rendering context\r\n  } else console.log(\"canvas not supported\");\r\n};\r\n\r\nconst verticleLines = (elapsedTime) => {\r\n  for (let i = 0; i < 3; i += 1) {\r\n    const xCoords = 633 * (i + 1) - ((widthPerSecond * elapsedTime) % 633);\r\n\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = \"gray\";\r\n    ctx.lineWidth = 1;\r\n    ctx.moveTo(xCoords, 15);\r\n    ctx.lineTo(xCoords, 195);\r\n    ctx.stroke();\r\n  }\r\n};\r\nconst spawnPrompts = (time, symbol) => {\r\n  const xPosition = 1897.5 - time * widthPerSecond;\r\n  ctx.fillStyle = \"blue\";\r\n  ctx.beginPath();\r\n  // ctx.arc(xPosition, yPosition, 22.5, 0, 2 * Math.PI);\r\n  ctx.drawImage(\r\n    symbols[symbol],\r\n    xPosition - 22.5,\r\n    yPosition[symbol] - 22.5,\r\n    55,\r\n    55\r\n  );\r\n  ctx.fill();\r\n  ctx.stroke();\r\n};\r\nconst spanwLongPrompts = (\r\n  elapsedTime,\r\n  promptTime,\r\n  travelTime,\r\n  duration,\r\n  type,\r\n  symbol\r\n) => {\r\n  textImage.src = longPromptText[type];\r\n  const startArc = 1897.5 - travelTime * widthPerSecond;\r\n  const endArc = startArc + duration * widthPerSecond;\r\n  const textP = startArc + (duration * widthPerSecond) / 2 - 25;\r\n  let size;\r\n  const clicked = symbol === key && elapsedTime >= promptTime - 0.2;\r\n\r\n  if (type === \"hold\") size = clicked ? 50 : 55;\r\n  if (type === \"rapid\") size = clicked ? 50 : 55;\r\n  ctx.font = \"40px serif\";\r\n  ctx.strokeStyle = type === \"rapid\" ? \"blue\" : \"#add8e6\";\r\n  ctx.lineWidth = 10;\r\n  ctx.beginPath();\r\n  ctx.arc(startArc, yPosition[symbol], 15.5, 0, 2 * Math.PI);\r\n  ctx.arc(endArc, yPosition[symbol], 15.5, 0, 2 * Math.PI);\r\n  ctx.stroke();\r\n  ctx.beginPath();\r\n  ctx.drawImage(\r\n    symbols[symbol],\r\n    startArc - 22.5,\r\n    yPosition[symbol] - 22.5,\r\n    size,\r\n    size\r\n  );\r\n  ctx.drawImage(textImage, textP, yPosition[symbol] - 22.5, 75, 35);\r\n  ctx.drawImage(\r\n    symbols[symbol],\r\n    endArc - 22.5,\r\n    yPosition[symbol] - 22.5,\r\n    size,\r\n    size\r\n  );\r\n  ctx.stroke();\r\n};\r\nexport const validPrompts = (time, buttons) => {\r\n  ctx.clearRect(0, 0, myCanvas.width, myCanvas.height);\r\n  verticleLines(time);\r\n  for (let i = 0; i < buttons.length; i += 1) {\r\n    const prompt = buttons[i];\r\n    const valid =\r\n      prompt.time + prompt.duration + 0.2 >= time &&\r\n      time >= prompt.time - entryOffset;\r\n    if (valid) {\r\n      switch (prompt.type) {\r\n        case \"click\":\r\n          spawnPrompts(time + entryOffset - prompt.time, prompt.key);\r\n          break;\r\n        default:\r\n          spanwLongPrompts(\r\n            time,\r\n            prompt.time,\r\n            time + entryOffset - prompt.time,\r\n            prompt.duration,\r\n            prompt.type,\r\n            prompt.key\r\n          );\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nwindow.addEventListener(\"resize\", () => {\r\n  myCanvas.width = window.innerWidth;\r\n});\r\n\r\nwindow.addEventListener(\"keydown\", (e) => {\r\n  key = e.key;\r\n});\r\nwindow.addEventListener(\"keyup\", () => {\r\n  key = null;\r\n});\r\n","import upImg from \"../images/up.png\";\r\nimport leftImg from \"../images/left.png\";\r\nimport downImg from \"../images/down.png\";\r\nimport rightImg from \"../images/right.png\";\r\nimport holdText from \"../images/hold.png\";\r\nimport rapidText from \"../images/rapid.png\";\r\n\r\nlet myCanvas;\r\nlet ctx;\r\n// a time point every x pixels of the canvas\r\nconst pixelsPerIndicator = 29;\r\n// each indicator represent 100 miliseconds\r\nlet numberOfIndicators = 0;\r\nlet canvaswidth = 0;\r\nlet speed = 0;\r\nlet offSet = 0;\r\n\r\nconst symbols = {\r\n  ArrowUp: document.createElement(\"img\"),\r\n  ArrowLeft: document.createElement(\"img\"),\r\n  ArrowRight: document.createElement(\"img\"),\r\n  ArrowDown: document.createElement(\"img\"),\r\n};\r\nconst longPromptText = {\r\n  rapid: rapidText,\r\n  hold: holdText,\r\n};\r\n\r\nsymbols.ArrowUp.src = upImg;\r\nsymbols.ArrowLeft.src = leftImg;\r\nsymbols.ArrowDown.src = downImg;\r\nsymbols.ArrowRight.src = rightImg;\r\n\r\nconst textImage = document.createElement(\"img\");\r\n\r\nexport function initMap(id) {\r\n  myCanvas = document.querySelector(id);\r\n  myCanvas.width = window.innerWidth;\r\n  myCanvas.height = 150;\r\n  canvaswidth = myCanvas.width;\r\n  numberOfIndicators = Math.ceil(myCanvas.clientWidth / pixelsPerIndicator);\r\n  speed = canvaswidth / (numberOfIndicators / 10);\r\n  offSet = numberOfIndicators / 2 / 10;\r\n\r\n  if (myCanvas.getContext) {\r\n    ctx = myCanvas.getContext(\"2d\"); // rendering context\r\n  } else console.log(\"canvas not supported\");\r\n}\r\n\r\nfunction drawClickPrompt(arrowDirection, xPosition) {\r\n  ctx.beginPath();\r\n  // ctx.arc(xPosition, 50, 22.5, 0, 2 * Math.PI);\r\n  ctx.drawImage(symbols[arrowDirection], xPosition - 20.5, 10, 50, 50);\r\n}\r\nfunction drawLongPrompt(arrowDirection, startArc, endArc, type) {\r\n  const size = 50;\r\n  textImage.src = longPromptText[type];\r\n  const textP = startArc + 100;\r\n\r\n  ctx.strokeStyle = type === \"rapid\" ? \"blue\" : \"#add8e6\";\r\n  ctx.lineWidth = 10;\r\n  ctx.beginPath();\r\n  ctx.arc(startArc, 30, 15.5, 0, 2 * Math.PI);\r\n  ctx.arc(endArc, 30, 15.5, 0, 2 * Math.PI);\r\n  ctx.stroke();\r\n  ctx.beginPath();\r\n  ctx.drawImage(symbols[arrowDirection], startArc - 22.5, 10, size, size);\r\n  ctx.drawImage(textImage, textP, 10, 75, 35);\r\n  ctx.drawImage(symbols[arrowDirection], endArc - 22.5, 10, size, size);\r\n}\r\n\r\nfunction drawIndicators(seconds, totalIndicators) {\r\n  // total seconds to the center of the map.\r\n\r\n  for (let i = 0; i < totalIndicators; i += 1) {\r\n    const indicatorTime = i / 10;\r\n\r\n    const valid =\r\n      indicatorTime + offSet >= seconds && seconds >= indicatorTime - offSet;\r\n\r\n    if (valid) {\r\n      const timePassed = seconds - (indicatorTime - offSet);\r\n      const travelDistance = timePassed * speed;\r\n      const xCoords = canvaswidth - travelDistance;\r\n      const isInteger = indicatorTime - Math.floor(indicatorTime) === 0;\r\n      ctx.beginPath();\r\n      ctx.lineWidth = 2;\r\n      ctx.strokeStyle = \"gray\";\r\n      ctx.fillStyle = \"rgba(38, 199, 151, 0.741)\";\r\n      ctx.font = \"12px serif\";\r\n      ctx.moveTo(xCoords, 0);\r\n      ctx.lineTo(xCoords, isInteger ? 100 : 60);\r\n      ctx.fillText(indicatorTime, xCoords - 3, isInteger ? 112 : 72);\r\n      ctx.stroke();\r\n    }\r\n  }\r\n}\r\nfunction drawPrompts(seconds, prompts) {\r\n  // how many seconds before time the prompt should appear\r\n  for (let i = 0; i < prompts.length; i += 1) {\r\n    const prompt = prompts[i];\r\n    const valid =\r\n      prompt.time + prompt.duration + offSet >= seconds &&\r\n      seconds >= prompt.time - offSet;\r\n    if (valid) {\r\n      const timePassed = seconds - (prompt.time - offSet);\r\n      const travelDistance = timePassed * speed;\r\n      const xCoords = canvaswidth - travelDistance;\r\n\r\n      if (prompt.type === \"click\") {\r\n        drawClickPrompt(prompt.key, xCoords);\r\n      } else {\r\n        const endDistance =\r\n          Number(prompt.time + prompt.duration - seconds - offSet) * speed;\r\n        const endCoords = myCanvas.width + endDistance;\r\n        drawLongPrompt(prompt.key, xCoords, endCoords, prompt.type);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function drawMap(prompts = [], seconds = 0, duration = 0) {\r\n  ctx.clearRect(0, 0, myCanvas.width, myCanvas.height);\r\n  const totalIndicators = Number((duration * 10).toFixed(0));\r\n  drawIndicators(seconds, totalIndicators);\r\n  drawPrompts(seconds, prompts);\r\n\r\n  // draw triangle\r\n  const centerDistance = offSet * speed;\r\n  const centerCoords = Math.floor(canvaswidth - centerDistance);\r\n  ctx.beginPath();\r\n  ctx.moveTo(centerCoords, 30);\r\n  ctx.lineTo(centerCoords - 15, 0);\r\n  ctx.lineTo(centerCoords + 15, 0);\r\n  ctx.fillStyle = \"rgba(38, 199, 151, 0.741)\";\r\n  ctx.fill();\r\n}\r\n\r\nwindow.addEventListener(\"resize\", () => {\r\n  ctx.clearRect(0, 0, myCanvas.width, myCanvas.height);\r\n  myCanvas.width = window.innerWidth;\r\n  numberOfIndicators = Math.ceil(myCanvas.clientWidth / pixelsPerIndicator);\r\n  canvaswidth = myCanvas.width;\r\n  speed = canvaswidth / (numberOfIndicators / 10);\r\n  offSet = numberOfIndicators / 2 / 10;\r\n});\r\n","export function saveUserInfo(info) {\r\n  localStorage.setItem(\"info\", JSON.stringify(info));\r\n}\r\nexport function getUserInfo() {\r\n  const info = localStorage.getItem(\"info\");\r\n  return JSON.parse(info);\r\n}\r\nconst getMaps = () => {\r\n  let maps = JSON.parse(localStorage.getItem(\"maps\"));\r\n  if (!maps) {\r\n    localStorage.setItem(\"maps\", JSON.stringify([]));\r\n    maps = JSON.parse(localStorage.getItem(\"maps\"));\r\n  }\r\n  return maps;\r\n};\r\nexport function getLocalMap(id) {\r\n  const maps = getMaps();\r\n  const found = maps.find((map) => map.id === id);\r\n  return found?.beatMap;\r\n}\r\n\r\nexport function saveLocalMap({ id, beatMap }) {\r\n  const maps = getMaps();\r\n  // find the map\r\n  const target = maps.find((map) => map.id === id);\r\n  if (target) {\r\n    target.beatMap = beatMap;\r\n  } else {\r\n    maps.push({ id, beatMap });\r\n  }\r\n  localStorage.setItem(\"maps\", JSON.stringify(maps));\r\n}\r\nexport function deleteLocalMap(id) {\r\n  const maps = getMaps();\r\n  const filtered = maps.filter((map) => map.id !== id);\r\n  localStorage.setItem(\"maps\", JSON.stringify(filtered));\r\n}\r\nexport function updateSettings(property, value) {\r\n  let settings = JSON.parse(localStorage.getItem(\"settings\"));\r\n  if (!settings) {\r\n    localStorage.setItem(\r\n      \"settings\",\r\n      JSON.stringify({\r\n        music: 0.5,\r\n        hit: 0.5,\r\n        offset: 0,\r\n        opacity: 0.7,\r\n      })\r\n    );\r\n    settings = JSON.parse(localStorage.getItem(\"settings\"));\r\n  }\r\n  settings[property] = value;\r\n  localStorage.setItem(\"settings\", JSON.stringify(settings));\r\n}\r\n\r\nexport function getSettings() {\r\n  const defaultSettings = {\r\n    music: 0.5,\r\n    hit: 0.7,\r\n    offset: 0,\r\n    opacity: 1,\r\n  };\r\n\r\n  const settings = JSON.parse(localStorage.getItem(\"settings\"));\r\n  return settings || defaultSettings;\r\n}\r\n","import greatImg from \"../images/great.png\";\r\nimport missImg from \"../images/miss.png\";\r\nimport badImg from \"../images/bad.png\";\r\nimport goodImg from \"../images/good.png\";\r\n\r\nconst performanceImage = {\r\n  great: greatImg,\r\n  miss: missImg,\r\n  bad: badImg,\r\n  good: goodImg,\r\n};\r\n\r\nexport const feedBackVisualiserFactory = () => {\r\n  const performanceIndicator = document.querySelector(\r\n    \".performance-visualiser\"\r\n  );\r\n  const first = document.querySelector(\"#first\");\r\n  const second = document.querySelector(\"#second\");\r\n  const third = document.querySelector(\"#third\");\r\n  const fourth = document.querySelector(\"#fourth\");\r\n\r\n  const clearAnimation = (elements, newClass) => {\r\n    for (let i = 0; i < elements.length; i += 1) {\r\n      // eslint-disable-next-line no-param-reassign\r\n      elements[i].className = newClass;\r\n    }\r\n    // eslint-disable-next-line no-unused-expressions\r\n    // performanceIndicator.offsetTop; // cause the browser to repaint so the animations can restart.\r\n  };\r\n\r\n  const inputFeedback = (showInfo) => {\r\n    if (showInfo.Success) {\r\n      clearAnimation([first, second, third, fourth], \"button input-visualiser\");\r\n      switch (showInfo.Key) {\r\n        case \"ArrowUp\":\r\n          first.classList.toggle(\"explode-animation\");\r\n\r\n          break;\r\n        case \"ArrowRight\":\r\n          second.classList.toggle(\"explode-animation\");\r\n\r\n          break;\r\n        case \"ArrowLeft\":\r\n          third.classList.toggle(\"explode-animation\");\r\n\r\n          break;\r\n        case \"ArrowDown\":\r\n          fourth.classList.toggle(\"explode-animation\");\r\n\r\n          break;\r\n        default:\r\n      }\r\n    }\r\n  };\r\n  const showIndicator = (showInfo) => {\r\n    if (showInfo.Success) {\r\n      performanceIndicator.style.backgroundImage = `url(${\r\n        performanceImage[showInfo.performance]\r\n      })`;\r\n      clearAnimation([performanceIndicator], \"performance-visualiser\");\r\n      requestAnimationFrame(() => {\r\n        requestAnimationFrame(() => {\r\n          performanceIndicator.classList.toggle(\"popup-animation\");\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  return { inputFeedback, showIndicator, clearAnimation };\r\n};\r\nexport const autoThumbMovement = (position) => {\r\n  if (position > 1) return;\r\n  const thumb = document.querySelector(\".progress_thumb\");\r\n  const leftValue = position * 100;\r\n  thumb.style.left = `${leftValue}%`;\r\n};\r\nexport const moveProgressThumb = (event) => {\r\n  const progressBar = document.querySelector(\".p_container\");\r\n  const thumb = document.querySelector(\".progress_thumb\");\r\n  const coords = progressBar.getBoundingClientRect();\r\n  if (event.pageX < coords.left || event.pageX > coords.width + coords.left)\r\n    return;\r\n\r\n  thumb.style.left = `${((event.pageX - coords.left) / coords.width) * 100}%`;\r\n\r\n  // eslint-disable-next-line consistent-return\r\n  return (event.pageX - coords.left) / coords.width;\r\n};\r\nexport const mapProgressPrompts = (beatMap, duration) => {\r\n  const prompMap = document.querySelector(\"#prompt_location\");\r\n  const ctx = prompMap.getContext(\"2d\");\r\n  ctx.clearRect(0, 0, prompMap.width, prompMap.height);\r\n\r\n  for (let i = 0; i < beatMap.length; i += 1) {\r\n    const xPosition = (beatMap[i].time / duration) * prompMap.width;\r\n    const yPosition = beatMap[i].type === \"click\" ? 40 : 0;\r\n    ctx.strokeStyle =\r\n      // eslint-disable-next-line no-nested-ternary\r\n      beatMap[i].type === \"click\"\r\n        ? \"red\"\r\n        : beatMap[i].type === \"hold\"\r\n        ? \"rgb(12, 240, 240)\"\r\n        : \"blue\";\r\n    ctx.beginPath();\r\n    ctx.lineTo(xPosition, yPosition);\r\n    ctx.lineTo(xPosition, 80);\r\n    ctx.stroke();\r\n  }\r\n};\r\n","import rapidText from \"../images/rapid.png\";\r\nimport holdText from \"../images/hold.png\";\r\nimport clickText from \"../images/click.png\";\r\n\r\nexport function showEdit(show) {\r\n  const editBtn = document.querySelector(\"#exit\");\r\n\r\n  if (show) {\r\n    editBtn.style.display = \"inline-block\";\r\n    return;\r\n  }\r\n  editBtn.style.display = \"none\";\r\n}\r\n\r\nexport function focusBtn(element) {\r\n  const clickBtn = document.querySelector(\"#click-image\");\r\n  const holdBtn = document.querySelector(\"#hold-image\");\r\n  const rapidBtn = document.querySelector(\"#rapid-image\");\r\n  if ([clickBtn, holdBtn, rapidBtn].includes(element)) {\r\n    clickBtn.classList.remove(\"active-prompt\");\r\n    rapidBtn.classList.remove(\"active-prompt\");\r\n    holdBtn.classList.remove(\"active-prompt\");\r\n    element.classList.toggle(\"active-prompt\");\r\n  }\r\n}\r\nexport function closeEditorMenu() {\r\n  const Menu = document.querySelector(\"#modal\");\r\n  const selectedAudio = document.querySelector(\"#map-audio\");\r\n  Menu.style.display = \"none\";\r\n  selectedAudio.pause();\r\n}\r\nexport function openEditorMenu() {\r\n  const Menu = document.querySelector(\"#modal\");\r\n  Menu.style.display = \"flex\";\r\n}\r\n\r\nexport function loadingMap() {\r\n  const notSelectedSceen = document.querySelector(\".not-selected\");\r\n  const selectedSummary = document.querySelector(\"#selected-summary\");\r\n  const selectedStatus = document.querySelector(\"#selected-status\");\r\n  selectedSummary.style.display = \"none\";\r\n  notSelectedSceen.style.display = \"flex\";\r\n\r\n  selectedStatus.textContent = \"Loading...\";\r\n}\r\nconst stopLoadingMap = () => {\r\n  const notSelectedSceen = document.querySelector(\".not-selected\");\r\n  const selectedSummary = document.querySelector(\"#selected-summary\");\r\n  notSelectedSceen.style.display = \"none\";\r\n  selectedSummary.style.display = \"flex\";\r\n};\r\nexport function updateMediaTime(elapsedTime) {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  const backgroundVideo = document.querySelector(\"#background-video\");\r\n  Audio.currentTime = elapsedTime;\r\n  backgroundVideo.currentTime = elapsedTime;\r\n}\r\nexport function updateDomTime(elapsedTime) {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  document.querySelector(\"#ptime\").textContent = ` ${elapsedTime.toFixed(\r\n    3\r\n  )} / ${Audio.duration}`;\r\n\r\n  const Score = document.querySelector(\"#score\");\r\n  Score.textContent = `${elapsedTime.toFixed(1)} `;\r\n}\r\n\r\nexport function editorPlay(time) {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  const backgroundVideo = document.querySelector(\"#background-video\");\r\n  const playBtn = document.querySelector(\"#play\");\r\n\r\n  Audio.currentTime = time;\r\n  backgroundVideo.currentTime = time;\r\n  Audio.play();\r\n  backgroundVideo.play();\r\n\r\n  playBtn.textContent = \"\";\r\n}\r\nexport function editorPause() {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  const backgroundVideo = document.querySelector(\"#background-video\");\r\n  const playBtn = document.querySelector(\"#play\");\r\n\r\n  Audio.pause();\r\n  backgroundVideo.pause();\r\n\r\n  playBtn.textContent = \"\";\r\n}\r\n\r\nconst highLightSelected = (id) => {\r\n  const beatMaps = document.querySelectorAll(\".beat-map\");\r\n  beatMaps.forEach((listItem) => {\r\n    if (listItem.id === `map-${id}`) {\r\n      listItem.classList.add(\"active\");\r\n      return;\r\n    }\r\n    listItem.classList.remove(\"active\");\r\n  });\r\n};\r\nexport function viewSwitch(buttonID) {\r\n  const buttonGroup = document.querySelector(\".button-group\");\r\n  const addMapForm = document.querySelector(\"#add-map-form\");\r\n  const summaryWrapper = document.querySelector(\"#summary-wrapper\");\r\n  const buttonGroupMember = buttonGroup.children;\r\n\r\n  Object.keys(buttonGroupMember).forEach((child) => {\r\n    const element = buttonGroupMember[child];\r\n\r\n    if (element.id === buttonID) {\r\n      element.classList.add(\"active\");\r\n\r\n      const selectedButton = element.getAttribute(\"id\");\r\n\r\n      const checkSelected = selectedButton === \"selected\";\r\n      const checkCreate = selectedButton === \"add\";\r\n      // add form style change\r\n      addMapForm.style.display = checkCreate ? \"flex\" : \"none\";\r\n\r\n      // login form style change\r\n      summaryWrapper.style.display = checkSelected ? \"flex\" : \"none\";\r\n\r\n      return;\r\n    }\r\n    element.classList.remove(\"active\");\r\n  });\r\n}\r\n\r\nexport function updatePlaySpeed(playBackRate) {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  const backgroundVideo = document.querySelector(\"#background-video\");\r\n  Audio.playbackRate = playBackRate;\r\n  backgroundVideo.playbackRate = playBackRate;\r\n}\r\n\r\nexport function showSelectedSong(\r\n  beatMap,\r\n  previewExtension,\r\n  audioURL,\r\n  backgroundURL\r\n) {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  const backgroundVideo = document.querySelector(\"#background-video\");\r\n  const backgroundImage = document.querySelector(\"#background-image\");\r\n  const selectedAudio = document.querySelector(\"#map-audio\");\r\n  const selectName = document.querySelector(\"#select-name \");\r\n  const nameEdit = document.querySelector(\"#name-edit>input[type='text']\");\r\n  const selectVideo = document.querySelector(\"#map-video\");\r\n  const selectImage = document.querySelector(\"#map-image\");\r\n  // remove no selected message\r\n  stopLoadingMap();\r\n  highLightSelected(beatMap.id);\r\n  // add audio src\r\n  Audio.src = audioURL;\r\n  selectVideo.style.display = \"none\";\r\n  selectImage.style.display = \"none\";\r\n  backgroundVideo.style.display = \"none\";\r\n  backgroundImage.style.display = \"none\";\r\n  selectName.textContent = beatMap.name;\r\n  nameEdit.value = beatMap.name;\r\n\r\n  selectedAudio.src = audioURL;\r\n  const extension = previewExtension;\r\n  // show either video or image based on background extension\r\n  if (extension === \"mp4\") {\r\n    backgroundVideo.src = backgroundURL;\r\n    backgroundVideo.style.display = \"block\";\r\n\r\n    // for the summary\r\n    selectVideo.src = backgroundURL;\r\n    selectVideo.style.display = \"block\";\r\n    selectVideo.play();\r\n  } else {\r\n    backgroundImage.style.backgroundImage = `url(${backgroundURL})`;\r\n    selectImage.src = backgroundURL;\r\n    selectImage.style.display = \"block\";\r\n    backgroundImage.style.display = \"block\";\r\n  }\r\n}\r\n\r\nexport function displaySelectedStatus(text) {\r\n  const notSelected = document.querySelector(\".not-selected\");\r\n  notSelected.style.display = \"block\";\r\n  const selectSummary = document.querySelector(\"#selected-summary\");\r\n  selectSummary.style.display = \"none\";\r\n\r\n  const selectedStatus = document.querySelector(\"#selected-status\");\r\n  selectedStatus.textContent = text;\r\n  showEdit(false);\r\n}\r\n\r\nexport function changeMapName(id, value) {\r\n  const mapName = document.querySelector(`#map-${id} .map-name`);\r\n  mapName.textContent = value;\r\n}\r\nexport function listBeatMap(beatMap, extension, source) {\r\n  const mapList = document.querySelector(\"#map-list\");\r\n  const listItem = document.createElement(\"li\");\r\n\r\n  listItem.id = `map-${beatMap.id}`;\r\n  listItem.classList.add(\"beat-map\");\r\n  const optionButton = document.createElement(\"span\");\r\n  optionButton.innerHTML = \"&#x22EF\";\r\n  optionButton.classList.add(\"map-option\");\r\n  const optionsList = document.createElement(\"ul\");\r\n  optionsList.classList.add(\"option-list\");\r\n\r\n  listItem.append(optionsList);\r\n\r\n  // create the options\r\n  const play = document.createElement(\"a\");\r\n  play.textContent = \"Play\";\r\n  play.href = `player.html?song=${beatMap.id}`;\r\n  play.target = \"_blank attribute\";\r\n  optionsList.append(play);\r\n\r\n  const saveMap = document.createElement(\"li\");\r\n  saveMap.textContent = \"Save\";\r\n  if (beatMap.status === \"draft\") {\r\n    optionsList.append(saveMap);\r\n  }\r\n\r\n  const publishMap = document.createElement(\"li\");\r\n  publishMap.textContent = beatMap.status !== \"draft\" ? \"unpublish\" : \"publish\";\r\n  optionsList.append(publishMap);\r\n\r\n  const deleteMap = document.createElement(\"li\");\r\n  deleteMap.textContent = \"Delete\";\r\n  optionsList.append(deleteMap);\r\n  const clearLocal = document.createElement(\"li\");\r\n  clearLocal.textContent = \" Clear local\";\r\n  optionsList.append(clearLocal);\r\n\r\n  const backgroundType = extension;\r\n  let mapBackground;\r\n\r\n  if (backgroundType === \"mp4\") {\r\n    mapBackground = document.createElement(\"video\");\r\n    mapBackground.addEventListener(\"mouseenter\", (e) => {\r\n      e.target.play();\r\n    });\r\n    mapBackground.addEventListener(\"mouseleave\", (e) => {\r\n      e.target.pause();\r\n    });\r\n  } else {\r\n    mapBackground = document.createElement(\"img\");\r\n  }\r\n\r\n  mapBackground.classList.add(\"beat-map-image\");\r\n  mapBackground.src = source;\r\n  listItem.appendChild(mapBackground);\r\n  const mapInfo = document.createElement(\"div\");\r\n  mapInfo.classList.add(\"beat-map-text\");\r\n  listItem.appendChild(mapInfo);\r\n  const nameContainer = document.createElement(\"div\");\r\n  const mapName = document.createElement(\"span\");\r\n  mapName.classList.add(\"map-name\");\r\n  mapName.textContent = beatMap.name;\r\n  const mapStatus = document.createElement(\"span\");\r\n  mapStatus.className = `${beatMap.status}-status`;\r\n  if (beatMap.status !== \"draft\") {\r\n    mapStatus.textContent = beatMap.status;\r\n  }\r\n  nameContainer.append(mapName, mapStatus);\r\n\r\n  const mapUpdateDate = document.createElement(\"span\");\r\n  mapUpdateDate.textContent = `last updated: ${beatMap.dateUpdated}`;\r\n  mapInfo.append(nameContainer, mapUpdateDate);\r\n\r\n  listItem.append(optionButton);\r\n  mapList.prepend(listItem);\r\n  return {\r\n    listItem,\r\n    optionsList,\r\n    optionButton,\r\n    deleteMap,\r\n    saveMap,\r\n    publishMap,\r\n    clearLocal,\r\n    mapName,\r\n    mapStatus,\r\n  };\r\n}\r\n\r\nexport function showHideOption(optionList) {\r\n  const element = optionList;\r\n  const { display } = getComputedStyle(element);\r\n  element.style.display = display === \"none\" ? \"block\" : \"none\";\r\n}\r\n\r\nexport function authenicatedView() {\r\n  const loginForm = document.querySelector(\"#login\");\r\n  const addMapArea = document.querySelector(\"#add-map\");\r\n  const userMaps = document.querySelector(\"#map-list\");\r\n  userMaps.style.display = \"block\";\r\n  addMapArea.style.display = \"grid\";\r\n  loginForm.style.display = \"none\";\r\n}\r\nexport function notAuthenticatedView() {\r\n  const loginForm = document.querySelector(\"#login\");\r\n  const addMapArea = document.querySelector(\"#add-map\");\r\n  const userMaps = document.querySelector(\"#map-list\");\r\n  loginForm.style.display = \"flex\";\r\n  addMapArea.style.display = \"none\";\r\n  userMaps.style.display = \"none\";\r\n}\r\nexport function currentAudioTime() {\r\n  const Audio = document.querySelector(\"#editor-audio\");\r\n  return Audio.currentTime;\r\n}\r\n\r\nexport function addPromptSrc() {\r\n  const rapidButton = document.querySelector(\"#rapid-image\");\r\n  rapidButton.src = rapidText;\r\n  const holdButton = document.querySelector(\"#hold-image\");\r\n  holdButton.src = holdText;\r\n  const clickButton = document.querySelector(\"#click-image\");\r\n  clickButton.src = clickText;\r\n}\r\n\r\nexport function addErrorMessage(message, id) {\r\n  const error = document.querySelector(`#${id}`);\r\n  error.textContent = message;\r\n}\r\nexport function opneNameEditForm(open) {\r\n  const nameEditOpen = document.querySelector(\"#name-edit-open\");\r\n  const nameEditForm = document.querySelector(\"#name-edit\");\r\n  nameEditForm.style.display = open ? \"flex\" : \"none\";\r\n  nameEditOpen.style.display = open ? \"none\" : \"inline\";\r\n}\r\n\r\nexport function showLoading(id, display) {\r\n  const loadingIndicator = document.querySelector(`#${id}`);\r\n  loadingIndicator.style.display = display;\r\n}\r\n","const config = {\r\n  dealy: 3,\r\n  timingWindowEarly: 0.2,\r\n  timingWindowLate: 0.1,\r\n  pointWidth: 10,\r\n  pointSpacing: 10,\r\n  startTime: 3,\r\n  apiDomain: {\r\n    development: \"http://localhost:5000\",\r\n    production: \"https://kareokeapi.onrender.com/\",\r\n  },\r\n  // for fetch requests\r\n};\r\n\r\nexport default config;\r\n","import config from \"../config\";\r\nimport responseText from \"../utility.js/responseText\";\r\n\r\nconst { apiDomain } = config;\r\n\r\nexport default async function apiRequest({ url, options, headers = {} }) {\r\n  const location = [\"localhost\", \"127.0.0.1\"].includes(window.location.hostname)\r\n    ? apiDomain.development\r\n    : apiDomain.production;\r\n  const response = await fetch(`${location}/${url}`, {\r\n    mode: \"cors\",\r\n    credentials: \"include\",\r\n    headers: {\r\n      CSRF_TOKEN: sessionStorage.getItem(\"csrfToken\"),\r\n      ...headers,\r\n    },\r\n    ...options,\r\n  });\r\n\r\n  if (response.ok === false) {\r\n    const message = await response.text();\r\n    throw new Error(responseText(message));\r\n  }\r\n\r\n  if (response.status === 401) {\r\n    // delete session data and storage, and logout from front end\r\n  }\r\n  return response;\r\n}\r\n","// gets the response text from an http error\r\n\r\nexport default function responseText(html) {\r\n  const container = document.createElement(\"div\");\r\n  container.innerHTML = html;\r\n  const text =\r\n    container.querySelector(\"p\")?.textContent ||\r\n    \"error could not compelte request\";\r\n  return text;\r\n}\r\n","import apiRequest from \"./main\";\r\n\r\nexport async function uploadBeatmap(formData) {\r\n  // upload map, audio, background.\r\n  const options = {\r\n    method: \"post\",\r\n    body: formData,\r\n  };\r\n  // make sure to add csrf toekn here\r\n  const headers = {};\r\n  const response = await apiRequest({\r\n    url: `kareoke/add_map`,\r\n    options,\r\n    headers,\r\n  });\r\n  const data = await response.json();\r\n\r\n  return data;\r\n}\r\nexport async function editMedia(formData) {\r\n  const options = {\r\n    method: \"put\",\r\n    body: formData,\r\n  };\r\n  const headers = {};\r\n  const response = await apiRequest({\r\n    url: `kareoke/change_media`,\r\n    options,\r\n    headers,\r\n  });\r\n  const data = await response.text();\r\n  return data;\r\n}\r\n\r\nexport async function getBeatMaps(page, search, signal) {\r\n  const options = {\r\n    method: \"get\",\r\n    signal,\r\n  };\r\n  const headers = {};\r\n  const response = await apiRequest({\r\n    url: `kareoke/get_published?page=${page}&search=${search}`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.json();\r\n\r\n  return data;\r\n}\r\nexport async function getUserBeatMaps() {\r\n  const options = {\r\n    method: \"get\",\r\n  };\r\n  const headers = {};\r\n  const response = await apiRequest({\r\n    url: `kareoke/get_user_maps`,\r\n    options,\r\n    headers,\r\n  });\r\n  const data = await response.json();\r\n  return data;\r\n}\r\n\r\nexport async function getBeatMap(id, signal) {\r\n  const options = {\r\n    method: \"get\",\r\n    signal,\r\n  };\r\n  const headers = {};\r\n  const response = await apiRequest({\r\n    url: `kareoke/get_map?mapID=${id}`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.json();\r\n\r\n  return data;\r\n}\r\nexport async function getMedia(url, signal) {\r\n  const response = await fetch(url, {\r\n    method: \"get\",\r\n    signal,\r\n  });\r\n\r\n  const data = await response.blob();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function saveBeatMap(mapData) {\r\n  const options = {\r\n    method: \"put\",\r\n    body: JSON.stringify(mapData),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `kareoke/save_map`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\nexport async function deleteMap(id) {\r\n  const options = {\r\n    method: \"delete\",\r\n    body: JSON.stringify({ id }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `kareoke/delete_map`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function saveHighScore(score, beatMapID) {\r\n  const options = {\r\n    method: \"put\",\r\n    body: JSON.stringify({ score, beatMapID }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `kareoke/highscore`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function getMaps() {\r\n  const options = {\r\n    method: \"get\",\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n\r\n  const response = await apiRequest({\r\n    url: `kareoke/get_maps`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.json();\r\n\r\n  return data;\r\n}\r\nexport async function publishRequest(beatMapID) {\r\n  const options = {\r\n    method: \"post\",\r\n    body: JSON.stringify({ beatMapID }),\r\n  };\r\n  const headers = { \"Content-Type\": \"application/json\" };\r\n  const response = await apiRequest({\r\n    url: `kareoke/publish_request`,\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n","import \"../kareoke_player/player.css\";\r\nimport \"./editor.css\";\r\nimport \"../general.css\";\r\n// import gamePlayerLogic from \"../player-parts/map-visualizer\";\r\nimport { validPrompts, init } from \"../canvas/canvas\";\r\nimport { initMap, drawMap } from \"../canvas/time-map\";\r\nimport { deleteLocalMap } from \"../utility.js/storage\";\r\n\r\nimport {\r\n  autoThumbMovement,\r\n  mapProgressPrompts,\r\n  moveProgressThumb,\r\n} from \"../player-parts/display-parts\";\r\n\r\nimport editorFactory from \"../managers/editor_manager\";\r\nimport {\r\n  authenicatedView,\r\n  notAuthenticatedView,\r\n  updateDomTime,\r\n  updateMediaTime,\r\n  viewSwitch,\r\n  listBeatMap,\r\n  loadingMap,\r\n  showSelectedSong,\r\n  updatePlaySpeed,\r\n  editorPlay,\r\n  editorPause,\r\n  closeEditorMenu,\r\n  openEditorMenu,\r\n  focusBtn,\r\n  currentAudioTime,\r\n  displaySelectedStatus,\r\n  showHideOption,\r\n  addPromptSrc,\r\n  showEdit,\r\n  addErrorMessage,\r\n  opneNameEditForm,\r\n  changeMapName,\r\n  showLoading,\r\n} from \"../dom-manipulation/editor-dom\";\r\nimport beatMapManager from \"../managers/map_manager\";\r\nimport userFactory from \"../managers/user-manager\";\r\n\r\nconst editor = editorFactory();\r\nconst mapManager = beatMapManager();\r\nconst userManager = userFactory();\r\nlet changingBackground = false;\r\nlet changingAudio = false;\r\nlet changingName = false;\r\ninit();\r\ninitMap(\"#time-map\");\r\naddPromptSrc();\r\nlet animationID;\r\n\r\nconst loadMedia = (audio, background, extension) => {\r\n  mapManager\r\n    .generateBlobUrl({\r\n      audio,\r\n      background,\r\n    })\r\n    .then(() => {\r\n      showSelectedSong(\r\n        mapManager.getSelectedMap(),\r\n        extension,\r\n        mapManager.getAudioUrl(),\r\n        mapManager.getBackgroundUrl()\r\n      );\r\n      showEdit(true);\r\n    });\r\n};\r\nconst setSelectedMap = (beatMap, extension) => {\r\n  mapManager.setSelectedMap(beatMap);\r\n  editor.setBeatMap(mapManager.getSelectedMap().beatMap);\r\n  loadMedia(beatMap.audio, beatMap.background, extension);\r\n};\r\n\r\nconst addMapToList = (beatMap) => {\r\n  const mediaExtension = mapManager.getExtension(beatMap.background);\r\n  const mediaSource = beatMap.background;\r\n  let loadingDelete = false;\r\n  let loadingPublish = false;\r\n  let loadingSave = false;\r\n  const {\r\n    listItem,\r\n    optionButton,\r\n    optionsList,\r\n    saveMap,\r\n    deleteMap,\r\n    clearLocal,\r\n    publishMap,\r\n    mapStatus,\r\n  } = listBeatMap(beatMap, mediaExtension, mediaSource);\r\n  listItem.addEventListener(\"click\", () => {\r\n    const selectedMap = mapManager.getSelectedMap();\r\n    if (selectedMap?.id === beatMap.id) {\r\n      return;\r\n    }\r\n    showEdit(false);\r\n    loadingMap();\r\n    mapManager.abortSelection();\r\n    setSelectedMap(beatMap, mediaExtension);\r\n    editor.setElapsedTime(0);\r\n    editor.setPreviousTime(0);\r\n  });\r\n  optionButton.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n    showHideOption(optionsList);\r\n  });\r\n  optionsList.addEventListener(\"click\", (e) => {\r\n    e.stopPropagation();\r\n  });\r\n  if (beatMap.status === \"draft\") {\r\n    saveMap.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      if (loadingSave) return;\r\n      saveMap.textContent = \"Saving...\";\r\n      loadingSave = true;\r\n\r\n      const { id } = beatMap;\r\n      mapManager\r\n        .saveMapRemote(id)\r\n        .then((res) => {\r\n          alert(res);\r\n        })\r\n        .finally(() => {\r\n          saveMap.textContent = \"Save\";\r\n          loadingSave = false;\r\n        });\r\n    });\r\n  }\r\n\r\n  deleteMap.addEventListener(\"click\", () => {\r\n    if (loadingDelete) return;\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const acceptDelete = confirm(\"All map data will be deleted\");\r\n    if (!acceptDelete) return;\r\n    loadingDelete = true;\r\n    deleteMap.textContent = \"Deleting...\";\r\n    mapManager\r\n      .deleteBeatMap(beatMap.id)\r\n      .then((res) => {\r\n        listItem.remove();\r\n        if (mapManager.getSelectedMap() === null) {\r\n          displaySelectedStatus(\"No map selected\");\r\n        }\r\n        alert(res);\r\n      })\r\n      .finally(() => {\r\n        loadingDelete = false;\r\n        deleteMap.textContent = \"delete\";\r\n      });\r\n  });\r\n  clearLocal.addEventListener(\"click\", () => {\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const acceptDelete = confirm(\r\n      \"Local data will be deleted (will revert to remote data)\"\r\n    );\r\n    if (!acceptDelete) return;\r\n\r\n    deleteLocalMap(beatMap.id);\r\n    editor.setBeatMap(JSON.parse(beatMap.beatMap));\r\n    alert(\"local data deleted\");\r\n  });\r\n  publishMap.addEventListener(\"click\", () => {\r\n    if (loadingPublish) return;\r\n    const message = {\r\n      draft:\r\n        \"Map will be put up for review and you wont be able to edit it during this period\",\r\n      pending: \"Map will be removed from publish queue\",\r\n      published: \"Map will no longer be publicly available\",\r\n    };\r\n\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const accept = confirm(message[beatMap.status]);\r\n    if (accept) {\r\n      loadingPublish = true;\r\n      publishMap.textContent = \"....\";\r\n      mapManager\r\n        .publishMap(beatMap.id)\r\n        .then((res) => {\r\n          // eslint-disable-next-line no-param-reassign\r\n          beatMap.status = res;\r\n        })\r\n        .finally(() => {\r\n          loadingPublish = false;\r\n          publishMap.textContent =\r\n            beatMap.status === \"draft\" ? \"publish\" : \"unpublish\";\r\n          mapStatus.textContent =\r\n            beatMap.status === \"draft\" ? \"\" : beatMap.status;\r\n          mapStatus.className = `${beatMap.status}-status`;\r\n        });\r\n    }\r\n  });\r\n};\r\n\r\nconst stopEditor = () => {\r\n  // clearInterval(intervalID);\r\n  cancelAnimationFrame(animationID);\r\n  editor.setPlay(false);\r\n  editorPause();\r\n};\r\nconst updateGraphics = () => {\r\n  validPrompts(editor.getElapsedTime(), editor.getBeatMap());\r\n  drawMap(\r\n    editor.getBeatMap(),\r\n    editor.getElapsedTime(),\r\n    editor.getAudioDuration()\r\n  );\r\n\r\n  updateDomTime(editor.getElapsedTime());\r\n  mapProgressPrompts(\r\n    editor.getBeatMap(), // replace with beatMap\r\n    editor.getAudioDuration()\r\n  );\r\n};\r\nconst timeController = () => {\r\n  const elapsedTime = editor.getElapsedTime();\r\n\r\n  const audioDuration = editor.getAudioDuration();\r\n\r\n  const previousTime = editor.getPreviousTime();\r\n  const playRate = editor.getPlayRate();\r\n\r\n  if (elapsedTime >= audioDuration) {\r\n    stopEditor();\r\n    return;\r\n  }\r\n  const currentTime = Number((Date.now() - editor.getStartTime()) / 1000);\r\n\r\n  editor.setPreviousTime(currentTime);\r\n  editor.setElapsedTime(previousTime * playRate);\r\n};\r\nconst AnimatePrompts = () => {\r\n  const elapsedTime = editor.getElapsedTime();\r\n\r\n  const audioDuration = editor.getAudioDuration();\r\n\r\n  if (elapsedTime >= audioDuration) {\r\n    stopEditor();\r\n    return;\r\n  }\r\n  // enable this when computer player is working is working\r\n  // gamePlayerLogic(elapsedTime);\r\n  autoThumbMovement(elapsedTime / audioDuration);\r\n  updateDomTime(elapsedTime);\r\n  validPrompts(elapsedTime, editor.getBeatMap());\r\n  drawMap(editor.getBeatMap(), elapsedTime, audioDuration);\r\n  timeController();\r\n  animationID = requestAnimationFrame(AnimatePrompts);\r\n};\r\nconst startEditor = () => {\r\n  animationID = requestAnimationFrame(AnimatePrompts);\r\n  editor.setStartTime(Date.now() - editor.getPreviousTime() * 1000);\r\n  editor.setPlay(true);\r\n  editorPlay(editor.getElapsedTime());\r\n};\r\nconst checkSelectedSong = () => {\r\n  mapManager\r\n    .checkSelectedSong()\r\n    .then((isSelected) => {\r\n      if (isSelected) {\r\n        const beatMap = mapManager.getSelectedMap();\r\n        const extension = mapManager.getExtension(beatMap.background);\r\n        loadMedia(beatMap.audio, beatMap.background, extension);\r\n        editor.setBeatMap(mapManager.getSelectedMap().beatMap);\r\n        showEdit(true);\r\n        return;\r\n      }\r\n      displaySelectedStatus(\"No map selected\");\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n      displaySelectedStatus(\"Error while fetching map\");\r\n\r\n      mapManager.clearSelectedMap();\r\n    });\r\n};\r\n\r\n// add event listners\r\n\r\ndocument.querySelector(\"#add\").addEventListener(\"click\", (e) => {\r\n  viewSwitch(e.target.id);\r\n});\r\ndocument.querySelector(\"#selected\").addEventListener(\"click\", (e) => {\r\n  viewSwitch(e.target.id);\r\n});\r\nconst addMapForm = document.querySelector(\"#add-map-form\");\r\naddMapForm.addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const submitButton = e.submitter;\r\n  submitButton.disabled = true;\r\n\r\n  const mapData = new FormData(addMapForm);\r\n  mapManager\r\n    .addBeatMap(mapData)\r\n    .then(async (res) => {\r\n      console.log(res);\r\n      const beatMap = res.map;\r\n\r\n      // put the map on the list of maps\r\n      addMapToList(beatMap);\r\n      // make the selected map the added map\r\n      setSelectedMap(beatMap, mapManager.getExtension(beatMap.background));\r\n      addMapForm.reset();\r\n      viewSwitch(\"selected\");\r\n      addErrorMessage(\"\", \"addmap-error\");\r\n    })\r\n    .catch((error) => {\r\n      console.log(error);\r\n      addErrorMessage(error, \"addmap-error\");\r\n    })\r\n    .finally(() => {\r\n      submitButton.disabled = false;\r\n    });\r\n});\r\n\r\ndocument.querySelector(\"#time_guage\").addEventListener(\"change\", (e) => {\r\n  editor.updateSpeed(Number(e.target.value));\r\n  updatePlaySpeed(editor.getPlayBackRate());\r\n});\r\n\r\ndocument.querySelector(\"#play\").addEventListener(\"click\", () => {\r\n  console.log(editor.getPlay());\r\n  if (editor.getPlay() === false) {\r\n    console.log(\"hi\");\r\n    startEditor();\r\n    return;\r\n  }\r\n  if (editor.getPlay()) {\r\n    stopEditor();\r\n  }\r\n});\r\n\r\ndocument.querySelector(\"#menu\").addEventListener(\"click\", () => {\r\n  openEditorMenu();\r\n  stopEditor();\r\n});\r\ndocument.querySelector(\"#exit\").addEventListener(\"click\", () => {\r\n  closeEditorMenu();\r\n});\r\n\r\nconst promptPosition = document.querySelector(\".get-prompt\");\r\npromptPosition.addEventListener(\"click\", (e) => {\r\n  if (e.target === promptPosition) return;\r\n  const time = editor.getElapsedTime().toFixed(1);\r\n\r\n  if (editor.checkOccupation(Number(time), mapManager.getSelectedMap().id)) {\r\n    console.log(\"space is occupied by a long prompt\");\r\n    return;\r\n  }\r\n  if (\r\n    editor.canPlace(\r\n      Number(time),\r\n      editor.getPromptDuration(),\r\n      mapManager.getSelectedMap().id\r\n    )\r\n  ) {\r\n    console.log(\"cant place that prompt here\");\r\n    return;\r\n  }\r\n  console.log(`${e.target.id}  time: ${editor.getElapsedTime().toFixed(1)}`);\r\n\r\n  editor.addPrompt(Number(time), e.target.id, mapManager.getSelectedMap().id);\r\n\r\n  updateGraphics();\r\n});\r\n\r\ndocument.querySelector(\"#click-image\").addEventListener(\"click\", (e) => {\r\n  editor.switchPrompt(\"click\", 0);\r\n  focusBtn(e.target);\r\n});\r\ndocument.querySelector(\"#hold-image\").addEventListener(\"click\", (e) => {\r\n  editor.switchPrompt(\"hold\", editor.getHoldDuration());\r\n  focusBtn(e.target);\r\n});\r\ndocument.querySelector(\"#rapid-image\").addEventListener(\"click\", (e) => {\r\n  editor.switchPrompt(\"rapid\", editor.getRapidDuration());\r\n  focusBtn(e.target);\r\n});\r\n\r\ndocument.querySelector(\"#r-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const rapidForm = new FormData(e.target);\r\n  editor.setRapidDuration(Number(rapidForm.get(\"duration\")));\r\n  const promptType = editor.getPromptType();\r\n  if (promptType === \"rapid\") {\r\n    editor.setPromptDuration(editor.getRapidDuration());\r\n  }\r\n});\r\n\r\ndocument.querySelector(\"#h-form\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const holdForm = new FormData(e.target);\r\n  editor.setHoldDuration(Number(holdForm.get(\"duration\")));\r\n  if (editor.getPromptType === \"hold\") {\r\n    editor.setPromptDuration(editor.getHoldDuration());\r\n  }\r\n});\r\n\r\nconst progressBar = document.querySelector(\".progress_section\");\r\nprogressBar.addEventListener(\"mousedown\", (e) => {\r\n  editor.setMoveThumb(true);\r\n  const timePosition = moveProgressThumb(e);\r\n  editor.progressBarTimeUpdate(timePosition);\r\n  updateGraphics();\r\n  updateMediaTime(editor.getElapsedTime());\r\n});\r\n\r\nprogressBar.addEventListener(\"mouseup\", () => {\r\n  editor.setMoveThumb(false);\r\n});\r\n\r\nprogressBar.addEventListener(\"mousemove\", (e) => {\r\n  if (editor.getMoveThumb()) {\r\n    const timePosition = moveProgressThumb(e);\r\n    editor.progressBarTimeUpdate(timePosition);\r\n    updateGraphics();\r\n    updateMediaTime(editor.getElapsedTime());\r\n  }\r\n});\r\n\r\ndocument.querySelector(\"body\").addEventListener(\"keydown\", (e) => {\r\n  if (editor.getPlay()) {\r\n    return;\r\n  }\r\n  if ([\"ArrowRight\", \"ArrowLeft\"].includes(e.key) === false) {\r\n    return;\r\n  }\r\n\r\n  const direction = e.key === \"ArrowRight\" ? \"foward\" : \"backward\";\r\n  editor.timeStep(direction);\r\n  autoThumbMovement(currentAudioTime() / editor.getAudioDuration());\r\n  updateGraphics();\r\n  updateMediaTime(editor.getElapsedTime());\r\n});\r\ndocument.querySelector(\"#name-edit-open\").addEventListener(\"click\", () => {\r\n  opneNameEditForm(true);\r\n});\r\ndocument.querySelector(\"#name-edit-close\").addEventListener(\"click\", () => {\r\n  opneNameEditForm(false);\r\n});\r\ndocument.querySelector(\"#name-edit\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  if (changingName) return;\r\n\r\n  changingName = true;\r\n  const { name, status, id } = mapManager.getSelectedMap();\r\n  if (status !== \"draft\") {\r\n    addErrorMessage(\"Only draft posts can be edited\", \"editname-error\");\r\n    return;\r\n  }\r\n  const formData = new FormData(e.target);\r\n  if (formData.get(\"map-name\") === name) return;\r\n  const submitButton = document.querySelector(\"#name-edit button\");\r\n  submitButton.disabled = true;\r\n  console.log(submitButton);\r\n\r\n  mapManager\r\n    .saveMapName(formData.get(\"map-name\"))\r\n    .then(({ reload, extension }) => {\r\n      changeMapName(id, formData.get(\"map-name\"));\r\n      opneNameEditForm(false);\r\n      addErrorMessage(\"\", \"editname-error\");\r\n      if (reload) {\r\n        // update selectedMap value\r\n        showSelectedSong(\r\n          mapManager.getSelectedMap(),\r\n          extension,\r\n          mapManager.getAudioUrl(),\r\n          mapManager.getBackgroundUrl()\r\n        );\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      console.log(err);\r\n      addErrorMessage(err, \"editname-error\");\r\n    })\r\n    .finally(() => {\r\n      changingName = false;\r\n      submitButton.disabled = false;\r\n    });\r\n});\r\ndocument.querySelector(\"#background-edit\").addEventListener(\"change\", (e) => {\r\n  if (changingBackground) return;\r\n  const file = e.target.files[0];\r\n  changingBackground = true;\r\n  // check on frontend if changing the size go over the maximum allowed beatMap size\r\n  showLoading(\"background-indicator\", \"block\");\r\n  mapManager\r\n    .changeMedia(\"background\", file)\r\n    .then(({ reload, extension }) => {\r\n      addErrorMessage(\"\", \"editbackground-error\");\r\n      if (reload) {\r\n        console.log(\"reloading\");\r\n        loadMedia(\r\n          mapManager.getSelectedMap().audio,\r\n          mapManager.getSelectedMap().background,\r\n          extension\r\n        );\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      addErrorMessage(err, \"editbackground-error\");\r\n      console.log(err);\r\n    })\r\n    .finally(() => {\r\n      showLoading(\"background-indicator\", \"none\");\r\n      changingBackground = false;\r\n    });\r\n});\r\ndocument.querySelector(\"#audio-edit\").addEventListener(\"change\", (e) => {\r\n  if (changingAudio) return;\r\n  const file = e.target.files[0];\r\n  changingAudio = true;\r\n  // check on frontend if changing the size go over the maximum allowed beatMap size\r\n  showLoading(\"audio-indicator\", \"block\");\r\n  mapManager\r\n    .changeMedia(\"audio\", file)\r\n    .then(({ reload, extension }) => {\r\n      addErrorMessage(\"\", \"editaudio-error\");\r\n      if (reload) {\r\n        console.log(\"reloading\");\r\n        loadMedia(\r\n          mapManager.getSelectedMap().audio,\r\n          mapManager.getSelectedMap().background,\r\n          extension\r\n        );\r\n      }\r\n    })\r\n    .catch((err) => {\r\n      addErrorMessage(err, \"editaudio-error\");\r\n      console.log(err);\r\n    })\r\n    .finally(() => {\r\n      showLoading(\"audio-indicator\", \"none\");\r\n      changingAudio = false;\r\n    });\r\n});\r\ndocument.querySelector(\"body\").addEventListener(\"keydown\", (e) => {\r\n  if (e.key !== \" \") return; // if the key pressed is not spacebar\r\n\r\n  if (getComputedStyle(document.querySelector(\"#modal\")).display === \"flex\")\r\n    return;\r\n  if (editor.getPlay() === false) {\r\n    startEditor();\r\n    return;\r\n  }\r\n  if (editor.getPlay() === true) {\r\n    stopEditor();\r\n  }\r\n});\r\n\r\ndocument.querySelector(\"#login\").addEventListener(\"submit\", (e) => {\r\n  e.preventDefault();\r\n  const submitButton = e.submitter;\r\n  submitButton.disabled = true;\r\n  const loginData = new FormData(e.target);\r\n\r\n  userManager\r\n    .handleLogin({\r\n      email: loginData.get(\"email\"),\r\n      password: loginData.get(\"password\"),\r\n    })\r\n    .then(async (res) => {\r\n      authenicatedView();\r\n      checkSelectedSong();\r\n      const beatMaps = await mapManager.handleGetUserBeatMaps();\r\n      // get user songs and display them on my map.\r\n      beatMaps.forEach((beatMap) => {\r\n        addMapToList(beatMap);\r\n      });\r\n\r\n      console.log(res);\r\n      viewSwitch(\"selected\");\r\n    })\r\n    .catch((err) => {\r\n      console.log(err);\r\n      addErrorMessage(err, \"login-error\");\r\n    })\r\n    .finally(() => {\r\n      submitButton.disabled = false;\r\n    });\r\n});\r\ndocument\r\n  .querySelector(\"#editor-audio\")\r\n  .addEventListener(\"loadedmetadata\", (e) => {\r\n    editor.setAudioDuration(e.target.duration);\r\n\r\n    updateGraphics();\r\n  });\r\nuserManager\r\n  .isLogin()\r\n  .then(async () => {\r\n    if (userManager.getUserData().isLogin) {\r\n      authenicatedView();\r\n      checkSelectedSong();\r\n      const beatMaps = await mapManager.handleGetUserBeatMaps();\r\n      // get user songs and display them on my map.\r\n      beatMaps.forEach((beatMap) => {\r\n        addMapToList(beatMap);\r\n      });\r\n      return;\r\n    }\r\n    notAuthenticatedView();\r\n  })\r\n  .catch((e) => {\r\n    console.log(e);\r\n    notAuthenticatedView();\r\n  });\r\n","import { saveLocalMap } from \"../utility.js/storage\";\r\n\r\nexport default function editorFactory() {\r\n  let elapsedTime = 0;\r\n  let previousTime = 0;\r\n  let startTime;\r\n  let Play = false;\r\n  let moveThumb = false;\r\n  let audioDuration;\r\n  let playbackRate = 1;\r\n  let beatMap = [];\r\n\r\n  let promptType = \"click\";\r\n  let promptDuration = 0;\r\n  let holdDuration = 1;\r\n  let rapidDuration = 1;\r\n\r\n  const input = {\r\n    one: \"ArrowUp\",\r\n    two: \"ArrowRight\",\r\n    three: \"ArrowLeft\",\r\n    four: \"ArrowDown\",\r\n  };\r\n\r\n  // getters\r\n  const getBeatMap = () => beatMap;\r\n  const getPlayRate = () => playbackRate;\r\n  const getElapsedTime = () => elapsedTime;\r\n  const getStartTime = () => startTime;\r\n  const getHoldDuration = () => holdDuration;\r\n  const getRapidDuration = () => rapidDuration;\r\n  const getPromptDuration = () => promptDuration;\r\n  const getPromptType = () => promptType;\r\n  const getMoveThumb = () => moveThumb;\r\n\r\n  const getPreviousTime = () => previousTime;\r\n  const getAudioDuration = () => audioDuration;\r\n  const getPlay = () => Play;\r\n\r\n  const getPlayBackRate = () => playbackRate;\r\n  // setters\r\n\r\n  const setBeatMap = (map) => {\r\n    beatMap = map;\r\n  };\r\n  const setRapidDuration = (value) => {\r\n    rapidDuration = value;\r\n  };\r\n  const setPromptDuration = (value) => {\r\n    promptDuration = value;\r\n  };\r\n  const setHoldDuration = (value) => {\r\n    holdDuration = value;\r\n  };\r\n  const setMoveThump = (value) => {\r\n    moveThumb = value;\r\n  };\r\n  const setPreviousTime = (value) => {\r\n    previousTime = value;\r\n  };\r\n  const setAudioDuration = (value) => {\r\n    audioDuration = value;\r\n  };\r\n  const setPlay = (value) => {\r\n    Play = value;\r\n  };\r\n  const setElapsedTime = (value) => {\r\n    elapsedTime = value;\r\n  };\r\n  const setStartTime = (value) => {\r\n    startTime = value;\r\n  };\r\n  const setMoveThumb = (value) => {\r\n    moveThumb = value;\r\n  };\r\n\r\n  const translateToKey = (position) => {\r\n    let key;\r\n    switch (position) {\r\n      case \"one\":\r\n        key = \"ArrowUp\";\r\n        break;\r\n      case \"two\":\r\n        key = \"ArrowLeft\";\r\n        break;\r\n      case \"three\":\r\n        key = \"ArrowRight\";\r\n        break;\r\n      case \"four\":\r\n        key = \"ArrowDown\";\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    return key;\r\n  };\r\n\r\n  const beatMapDownload = (map) => {\r\n    const myBlob = new Blob(map, { type: \"text/plain\" });\r\n    const blobURL = URL.createObjectURL(myBlob);\r\n    return blobURL;\r\n  };\r\n\r\n  const switchPrompt = (type, duration) => {\r\n    promptType = type;\r\n    promptDuration = duration;\r\n  };\r\n\r\n  const contructPrompt = (time, type, duration, place) => {\r\n    const key = input[place];\r\n\r\n    return { time, type, duration, key };\r\n  };\r\n\r\n  const canPlace = (time, duration) => {\r\n    // here we're  checking if adding a long prompt will overlap any other prompts in the beatMap\r\n    const check = beatMap.find(\r\n      (prompt) => prompt.time > time && prompt.time <= time + duration\r\n    );\r\n    return check;\r\n  };\r\n  const checkOccupation = (time) => {\r\n    // here we check if a user is trying to add a prompt within a long prompt.\r\n\r\n    const occupied = beatMap.find(\r\n      (prompt) => prompt.time < time && prompt.time + prompt.duration >= time\r\n    );\r\n\r\n    return occupied;\r\n  };\r\n  const removePrompt = (identifier, mapID) => {\r\n    beatMap = beatMap.filter((prompt) => prompt.time !== identifier);\r\n    saveLocalMap({ id: mapID, beatMap });\r\n\r\n    // eslint-disable-next-line no-param-reassign\r\n  };\r\n  const addPrompt = (time, place, mapID) => {\r\n    // check if prompt is there\r\n    const check = beatMap.find((beat) => beat.time === time);\r\n\r\n    if (check) {\r\n      removePrompt(time, mapID);\r\n      if (check.key === input[place]) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    const promptObject = contructPrompt(\r\n      time,\r\n      promptType,\r\n      promptDuration,\r\n      place\r\n    );\r\n\r\n    beatMap.push(promptObject);\r\n    beatMap.sort((a, b) => a.time - b.time);\r\n    saveLocalMap({ id: mapID, beatMap });\r\n  };\r\n\r\n  const timeStep = (direction) => {\r\n    const timePassed = Number(elapsedTime.toFixed(1));\r\n    if (Play) {\r\n      return;\r\n    }\r\n    if (previousTime - 0.1 < 0 && direction === \"backward\") {\r\n      return;\r\n    }\r\n    const move = direction === \"foward\" ? 0.1 : -0.1;\r\n    previousTime = (timePassed + move) / playbackRate;\r\n    elapsedTime = previousTime * playbackRate;\r\n  };\r\n\r\n  const pickTime = (time) => {\r\n    previousTime = time / playbackRate;\r\n    elapsedTime = previousTime * playbackRate;\r\n\r\n    return true;\r\n  };\r\n\r\n  const updateSpeed = (speed) => {\r\n    playbackRate = speed;\r\n    previousTime = elapsedTime / playbackRate;\r\n    elapsedTime = previousTime * playbackRate;\r\n    startTime = Date.now() - previousTime * 1000;\r\n  };\r\n  const progressBarTimeUpdate = (timePosition) => {\r\n    if (timePosition === undefined) {\r\n      console.log(\"undefined\");\r\n      return;\r\n    }\r\n    previousTime = (audioDuration * timePosition) / playbackRate;\r\n    elapsedTime = previousTime * playbackRate;\r\n    startTime = Date.now() - previousTime * 1000;\r\n  };\r\n\r\n  return {\r\n    getBeatMap,\r\n    setBeatMap,\r\n    progressBarTimeUpdate,\r\n    getElapsedTime,\r\n    updateSpeed,\r\n    addPrompt,\r\n    removePrompt,\r\n    pickTime,\r\n    checkOccupation,\r\n    canPlace,\r\n    timeStep,\r\n    switchPrompt,\r\n    translateToKey,\r\n    getPlayRate,\r\n    getStartTime,\r\n    getHoldDuration,\r\n    getRapidDuration,\r\n    getPromptType,\r\n    beatMapDownload,\r\n    getPromptDuration,\r\n    setRapidDuration,\r\n    setPromptDuration,\r\n    setHoldDuration,\r\n    setMoveThump,\r\n    getMoveThumb,\r\n    getPreviousTime,\r\n    setPreviousTime,\r\n    getAudioDuration,\r\n    setAudioDuration,\r\n    getPlay,\r\n    setPlay,\r\n    setElapsedTime,\r\n    getPlayBackRate,\r\n    setStartTime,\r\n    setMoveThumb,\r\n  };\r\n}\r\n","import {\r\n  getBeatMaps,\r\n  getBeatMap,\r\n  getMedia,\r\n  uploadBeatmap,\r\n  getUserBeatMaps,\r\n  saveBeatMap,\r\n  deleteMap,\r\n  editMedia,\r\n  publishRequest,\r\n} from \"../api/kareoke\";\r\n\r\nimport {\r\n  getLocalMap,\r\n  saveLocalMap,\r\n  deleteLocalMap,\r\n} from \"../utility.js/storage\";\r\n\r\nexport default function beatMapManager() {\r\n  let audioUrl;\r\n  let backgroundUrl;\r\n  let selectedMap;\r\n  let controller = new AbortController();\r\n  let searchController = new AbortController();\r\n\r\n  const getBackgroundUrl = () => backgroundUrl;\r\n  const getAudioUrl = () => audioUrl;\r\n  const getSelectedMap = () => selectedMap;\r\n\r\n  const setSelectedMap = (map) => {\r\n    selectedMap = map;\r\n    localStorage.setItem(\"selectedMap\", JSON.stringify(map));\r\n    const localMap = getLocalMap(selectedMap.id);\r\n\r\n    if (localMap) {\r\n      selectedMap.beatMap = localMap;\r\n    }\r\n    if (!localMap) {\r\n      const remoteMap = JSON.parse(selectedMap.beatMap);\r\n      selectedMap.beatMap = remoteMap;\r\n      saveLocalMap({ id: selectedMap.id, beatMap: remoteMap });\r\n    }\r\n  };\r\n\r\n  const clearSelectedMap = () => {\r\n    localStorage.removeItem(\"selectedMap\");\r\n    selectedMap = null;\r\n  };\r\n\r\n  const abortSelection = () => {\r\n    controller.abort();\r\n    controller = new AbortController();\r\n  };\r\n  const abortSearch = () => {\r\n    searchController.abort();\r\n    searchController = new AbortController();\r\n  };\r\n\r\n  const generateBlobUrl = async ({ audio, background }) => {\r\n    URL.revokeObjectURL(backgroundUrl);\r\n    URL.revokeObjectURL(audioUrl);\r\n    const [audioBlob, backgroundBloB] = await Promise.all([\r\n      getMedia(audio, controller.signal),\r\n      getMedia(background, controller.signal),\r\n    ]);\r\n    audioUrl = URL.createObjectURL(audioBlob);\r\n    backgroundUrl = URL.createObjectURL(backgroundBloB);\r\n  };\r\n  const getExtension = (name) => name.split(\".\").pop();\r\n\r\n  const checkSelectedSong = async () => {\r\n    const map = JSON.parse(localStorage.getItem(\"selectedMap\"));\r\n    if (map) {\r\n      const getMap = await getBeatMap(map.id, controller.signal);\r\n      setSelectedMap(getMap);\r\n      await generateBlobUrl(selectedMap);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n  const addBeatMap = (formData) => {\r\n    const response = uploadBeatmap(formData);\r\n    return response;\r\n  };\r\n  const changeMedia = async (type, file) => {\r\n    // check if changing media will exceed maximum file size\r\n    if (!selectedMap) {\r\n      throw new Error(\"No map selected\");\r\n    }\r\n    const currentMap = selectedMap;\r\n    const formData = new FormData();\r\n    formData.append(\"type\", type);\r\n    formData.append(\"media\", file);\r\n    formData.append(\"mapID\", selectedMap.id);\r\n    const newURL = await editMedia(formData);\r\n    selectedMap[type] = newURL;\r\n    return {\r\n      newURL,\r\n      reload: selectedMap === currentMap,\r\n      extension: getExtension(newURL),\r\n    };\r\n  };\r\n  const deleteBeatMap = async (id) => {\r\n    const response = await deleteMap(id);\r\n    URL.revokeObjectURL(backgroundUrl);\r\n    URL.revokeObjectURL(audioUrl);\r\n    if (id === selectedMap?.id) {\r\n      clearSelectedMap();\r\n    }\r\n    deleteLocalMap(id);\r\n\r\n    return response;\r\n  };\r\n  const publishMap = async (mapID) => {\r\n    const response = await publishRequest(mapID);\r\n    return response;\r\n  };\r\n\r\n  const saveMapRemote = async (id) => {\r\n    const response = await saveBeatMap({\r\n      id,\r\n      column: \"beatMap\",\r\n      value: getLocalMap(id) || [],\r\n    });\r\n\r\n    return response;\r\n  };\r\n\r\n  const saveMapName = async (value) => {\r\n    if (!selectedMap) {\r\n      throw new Error(\"No map selected\");\r\n    }\r\n    const currentMap = selectedMap;\r\n    const response = await saveBeatMap({\r\n      id: selectedMap.id,\r\n      column: \"name\",\r\n      value,\r\n    });\r\n    currentMap.name = value;\r\n    // fix this so that updating the selected map(dom) doesnt need the extension\r\n    return {\r\n      response,\r\n      reload: currentMap === selectedMap,\r\n      extension: getExtension(currentMap.background),\r\n    };\r\n  };\r\n  const handleGetUserBeatMaps = async () => {\r\n    const beatMaps = await getUserBeatMaps();\r\n    return beatMaps;\r\n  };\r\n  const handleGetBeatMaps = async (page, search) => {\r\n    const searchKeys = search\r\n      .split(\" \")\r\n      .filter((key) => key !== \"\")\r\n      .join(\",\");\r\n    abortSearch();\r\n    const response = await getBeatMaps(\r\n      page,\r\n      searchKeys,\r\n      searchController.signal\r\n    );\r\n    return response;\r\n  };\r\n  const loadMap = async (id) => {\r\n    const mapInfo = await getBeatMap(id);\r\n    await generateBlobUrl(mapInfo);\r\n\r\n    return {\r\n      mapInfo,\r\n      audioUrl,\r\n      backgroundUrl,\r\n      extension: getExtension(mapInfo.background),\r\n    };\r\n  };\r\n\r\n  return {\r\n    saveMapRemote,\r\n    handleGetUserBeatMaps,\r\n    handleGetBeatMaps,\r\n    getBackgroundUrl,\r\n    getAudioUrl,\r\n    generateBlobUrl,\r\n    getSelectedMap,\r\n    setSelectedMap,\r\n    addBeatMap,\r\n    checkSelectedSong,\r\n    getExtension,\r\n    abortSelection,\r\n    clearSelectedMap,\r\n    loadMap,\r\n    deleteBeatMap,\r\n    publishMap,\r\n    saveMapName,\r\n    changeMedia,\r\n  };\r\n}\r\n","import {\r\n  login,\r\n  logout,\r\n  check,\r\n  register,\r\n  changePassword,\r\n  editAccountInfo,\r\n  generateEmailVerifyToken,\r\n} from \"../api/authentication\";\r\nimport { getUserInfo, saveUserInfo } from \"../utility.js/storage\";\r\n\r\nexport default function userFactory() {\r\n  let userData = { isLogin: false };\r\n  const getUserData = () => userData;\r\n  const setUserData = (property, value) => {\r\n    userData[property] = value;\r\n  };\r\n  const handleLogin = async (authData) => {\r\n    const loginResponse = await login(authData);\r\n    userData = { ...loginResponse, isLogin: true };\r\n    sessionStorage.setItem(\"csrfToken\", userData.csrfToken);\r\n    saveUserInfo(userData);\r\n  };\r\n  const handleRegister = async (data) => {\r\n    const registerResponse = await register(data);\r\n\r\n    return registerResponse;\r\n  };\r\n  const isLogin = async () => {\r\n    const userInfo = getUserInfo();\r\n    if (!userInfo) {\r\n      return;\r\n    }\r\n\r\n    const response = await check(userInfo);\r\n    const responseData = await response.json();\r\n    userData = { ...responseData, isLogin: true };\r\n    sessionStorage.setItem(\"csrfToken\", userData.csrfToken);\r\n    saveUserInfo(responseData);\r\n  };\r\n  const handleLogout = async () => {\r\n    const userInfo = getUserInfo();\r\n    const logoutResponse = await logout(userInfo);\r\n    return logoutResponse;\r\n  };\r\n  const handlePasswordChange = async (currentPassword, newPassword) => {\r\n    const response = await changePassword(\r\n      userData.email,\r\n      currentPassword,\r\n      newPassword\r\n    );\r\n    return response;\r\n  };\r\n\r\n  const handleEditAccount = async (password, column, value) => {\r\n    const response = await editAccountInfo(\r\n      password,\r\n      userData.email,\r\n      column,\r\n      value\r\n    );\r\n    return response;\r\n  };\r\n  const handleEmailVerifyGeneration = async () => {\r\n    const response = await generateEmailVerifyToken();\r\n    return response;\r\n  };\r\n\r\n  return {\r\n    getUserData,\r\n    setUserData,\r\n    handleLogin,\r\n    handleRegister,\r\n    isLogin,\r\n    handleLogout,\r\n    handlePasswordChange,\r\n    handleEditAccount,\r\n    handleEmailVerifyGeneration,\r\n  };\r\n}\r\n","import apiRequest from \"./main\";\r\n\r\nexport async function login({ email, password }) {\r\n  const options = {\r\n    body: JSON.stringify({ email, password }),\r\n    method: \"post\",\r\n  };\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n  };\r\n\r\n  const response = await apiRequest({ url: \"auth/login\", options, headers });\r\n\r\n  const data = await response.json();\r\n\r\n  return data;\r\n}\r\nexport async function check({ csrfToken }) {\r\n  const options = { method: \"get\" };\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n    CSRF_TOKEN: csrfToken,\r\n  };\r\n  const response = await apiRequest({ url: \"auth/check\", options, headers });\r\n  return response;\r\n}\r\nexport async function logout({ csrfToken }) {\r\n  const options = { method: \"post\" };\r\n  const headers = {\r\n    CSRF_TOKEN: csrfToken,\r\n  };\r\n  const response = await apiRequest({ url: \"auth/logout\", options, headers });\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function register({ email, password, userName }) {\r\n  const options = {\r\n    body: JSON.stringify({ email, password, userName }),\r\n    method: \"post\",\r\n  };\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n  };\r\n\r\n  const response = await apiRequest({ url: \"auth/register\", options, headers });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\nexport async function editAccountInfo(password, email, column, value) {\r\n  const options = {\r\n    body: JSON.stringify({ email, password, column, value }),\r\n    method: \"post\",\r\n  };\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n  };\r\n\r\n  const response = await apiRequest({\r\n    url: \"auth/change_acount_info\",\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function generateEmailVerifyToken() {\r\n  const options = {\r\n    method: \"post\",\r\n  };\r\n\r\n  const response = await apiRequest({\r\n    url: \"auth/generate_verify_url\",\r\n    options,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\nexport async function verifyEmail(token) {\r\n  const options = {\r\n    body: JSON.stringify({ token }),\r\n    method: \"post\",\r\n  };\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n  };\r\n\r\n  const response = await apiRequest({\r\n    url: \"auth/verify_email\",\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n\r\nexport async function forgotPassword(form) {\r\n  const options = {\r\n    body: form,\r\n    method: \"post\",\r\n  };\r\n\r\n  const response = await apiRequest({\r\n    url: \"auth/generate_reset_url\",\r\n    options,\r\n  });\r\n\r\n  const data = await response.text();\r\n  return data;\r\n}\r\n\r\nexport async function recoverPassword(form) {\r\n  const options = {\r\n    body: form,\r\n    method: \"post\",\r\n  };\r\n\r\n  const response = await apiRequest({\r\n    url: \"auth/recover_password\",\r\n    options,\r\n  });\r\n\r\n  const data = await response.text();\r\n  return data;\r\n}\r\nexport async function changePassword(email, currentPassword, newPassword) {\r\n  const options = {\r\n    body: JSON.stringify({ email, currentPassword, newPassword }),\r\n    method: \"post\",\r\n  };\r\n  const headers = {\r\n    \"Content-Type\": \"application/json\",\r\n  };\r\n\r\n  const response = await apiRequest({\r\n    url: \"auth/change_password\",\r\n    options,\r\n    headers,\r\n  });\r\n\r\n  const data = await response.text();\r\n\r\n  return data;\r\n}\r\n"],"names":["__webpack_require__","g","globalThis","this","Function","e","window","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","i","Error","replace","p","widthPerSecond","Number","toFixed","key","symbols","ArrowUp","createElement","ArrowLeft","ArrowRight","ArrowDown","yPosition","ctx","myCanvas","textImage","longPromptText","rapid","hold","spawnPrompts","time","symbol","xPosition","fillStyle","beginPath","drawImage","fill","stroke","spanwLongPrompts","elapsedTime","promptTime","travelTime","duration","type","startArc","endArc","textP","size","clicked","font","strokeStyle","lineWidth","arc","Math","PI","validPrompts","buttons","clearRect","width","height","xCoords","moveTo","lineTo","verticleLines","prompt","addEventListener","innerWidth","numberOfIndicators","canvaswidth","speed","offSet","drawLongPrompt","arrowDirection","drawMap","prompts","seconds","totalIndicators","indicatorTime","isInteger","floor","fillText","drawIndicators","timePassed","endDistance","endCoords","drawPrompts","centerDistance","centerCoords","saveUserInfo","info","localStorage","setItem","JSON","stringify","getUserInfo","getItem","parse","ceil","clientWidth","getMaps","maps","getLocalMap","id","found","find","map","beatMap","saveLocalMap","target","push","deleteLocalMap","filtered","filter","autoThumbMovement","position","leftValue","querySelector","style","left","moveProgressThumb","event","progressBar","thumb","coords","getBoundingClientRect","pageX","showEdit","show","display","focusBtn","element","clickBtn","holdBtn","rapidBtn","includes","classList","remove","toggle","updateMediaTime","Audio","backgroundVideo","currentTime","updateDomTime","textContent","viewSwitch","buttonID","buttonGroup","addMapForm","summaryWrapper","buttonGroupMember","children","Object","keys","forEach","child","add","selectedButton","getAttribute","checkSelected","checkCreate","showSelectedSong","previewExtension","audioURL","backgroundURL","backgroundImage","selectedAudio","selectName","nameEdit","selectVideo","selectImage","notSelectedSceen","selectedSummary","stopLoadingMap","querySelectorAll","listItem","name","value","play","displaySelectedStatus","text","authenicatedView","loginForm","addMapArea","notAuthenticatedView","userMaps","addErrorMessage","message","opneNameEditForm","open","nameEditOpen","showLoading","apiDomain","dealy","timingWindowEarly","timingWindowLate","pointWidth","pointSpacing","startTime","development","production","async","url","options","headers","hostname","response","fetch","mode","credentials","CSRF_TOKEN","sessionStorage","ok","html","container","innerHTML","responseText","status","getBeatMap","signal","method","json","getMedia","blob","saveBeatMap","mapData","body","editor","audioDuration","previousTime","Play","moveThumb","playbackRate","promptType","promptDuration","holdDuration","rapidDuration","input","one","two","three","four","removePrompt","identifier","mapID","setBeatMap","progressBarTimeUpdate","timePosition","undefined","Date","now","console","log","getElapsedTime","updateSpeed","addPrompt","place","check","beat","promptObject","contructPrompt","sort","a","b","pickTime","checkOccupation","canPlace","timeStep","direction","switchPrompt","translateToKey","getPlayRate","getStartTime","getHoldDuration","getRapidDuration","getPromptType","beatMapDownload","myBlob","Blob","URL","createObjectURL","getPromptDuration","setRapidDuration","setPromptDuration","setHoldDuration","setMoveThump","getMoveThumb","getPreviousTime","setPreviousTime","getAudioDuration","setAudioDuration","getPlay","setPlay","setElapsedTime","getPlayBackRate","setStartTime","setMoveThumb","editorFactory","mapManager","audioUrl","backgroundUrl","selectedMap","controller","AbortController","searchController","setSelectedMap","localMap","remoteMap","clearSelectedMap","removeItem","generateBlobUrl","audio","background","revokeObjectURL","audioBlob","backgroundBloB","Promise","all","getExtension","split","pop","saveMapRemote","column","handleGetUserBeatMaps","getUserBeatMaps","handleGetBeatMaps","page","search","searchKeys","join","abort","getBeatMaps","getBackgroundUrl","getAudioUrl","getSelectedMap","addBeatMap","formData","uploadBeatmap","checkSelectedSong","getMap","abortSelection","loadMap","mapInfo","extension","deleteBeatMap","deleteMap","publishMap","beatMapID","publishRequest","saveMapName","currentMap","reload","changeMedia","file","FormData","append","newURL","editMedia","beatMapManager","userManager","userData","isLogin","getUserData","setUserData","property","handleLogin","authData","loginResponse","email","password","login","csrfToken","handleRegister","data","userName","register","userInfo","responseData","handleLogout","logout","handlePasswordChange","currentPassword","newPassword","changePassword","handleEditAccount","editAccountInfo","handleEmailVerifyGeneration","generateEmailVerifyToken","userFactory","changingBackground","changingAudio","changingName","animationID","getContext","loadMedia","then","addMapToList","mediaExtension","mediaSource","loadingDelete","loadingPublish","loadingSave","optionButton","optionsList","saveMap","clearLocal","mapStatus","source","mapList","href","mapBackground","pause","appendChild","nameContainer","mapName","className","mapUpdateDate","dateUpdated","prepend","listBeatMap","selectedStatus","loadingMap","stopPropagation","optionList","getComputedStyle","showHideOption","res","alert","finally","confirm","draft","pending","published","stopEditor","cancelAnimationFrame","playBtn","editorPause","updateGraphics","prompMap","mapProgressPrompts","AnimatePrompts","playRate","timeController","requestAnimationFrame","startEditor","editorPlay","isSelected","catch","error","preventDefault","submitButton","submitter","disabled","reset","playBackRate","updatePlaySpeed","Menu","closeEditorMenu","promptPosition","rapidForm","get","holdForm","changeMapName","err","files","loginData"],"sourceRoot":""}