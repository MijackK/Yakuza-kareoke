(()=>{"use strict";const{apiDomain:t}={dealy:3,timingWindowEarly:.2,timingWindowLate:.1,pointWidth:10,pointSpacing:10,startTime:3,apiDomain:{development:"localhost:5000",production:"nothing yet"}};async function e({url:e,options:n,headers:o}){const a=["localhost","127.0.0.1"].includes(window.location.hostname)?t.development:t.production,c=await fetch(`http://${a}/${e}`,{mode:"cors",credentials:"include",headers:{CSRF_TOKEN:sessionStorage.getItem("csrfToken"),...o},...n});if(!1===c.ok){const t=await c.text();throw new Error(function(t){const e=document.createElement("div");return e.innerHTML=t,e.querySelector("p")?.textContent||"error could not compelte request"}(t))}return c.status,c}let n=!1;const o=t=>{const e=document.createElement("li");e.style.padding="5px";const n=document.createElement("a");n.target="_blank",n.textContent=t.name,n.href=`player.html?song=${t.id}`,e.append(n);const o=document.createElement("span");return o.textContent=` by ${t.userName}`,e.append(o),e},a=async(t,o,a,c)=>{n||(n=!1,a.textContent="....",async function(t,n){const o={method:"post",body:JSON.stringify({beatMapID:t,resolution:n})},a=await e({url:"kareoke/publish_map",options:o,headers:{"Content-Type":"application/json"}});return await a.text()}(t,o).then((t=>{console.log(t),c.remove()})).catch((t=>{console.log(t),a.textContent="accept",alert("unable to publish map")})))},c=(t,n,o)=>{confirm("are you sure you want to delete this map?")&&(n.disabled=!0,async function(t){const n={method:"delete",body:JSON.stringify({id:t})},o=await e({url:"kareoke/delete_map_admin",options:n,headers:{"Content-Type":"application/json"}});return await o.text()}(t).then((t=>{console.log(t),o.remove()})).catch((t=>{n.disabled=!1,console.log(t)})))};(async function(){const t=await e({url:"kareoke/get_maps",options:{method:"get"},headers:{"Content-Type":"application/json"}});return await t.json()})().then((t=>{const e=document.querySelector("#request-list"),n=document.querySelector("#published-list"),i=document.querySelector("#unpublished-list"),s=t.filter((t=>"pending"===t.status)),r=t.filter((t=>"published"===t.status)),d=t.filter((t=>"draft"===t.status));s.forEach((t=>{const n=o(t),c=document.createElement("button");c.textContent="accept",n.append(c),c.addEventListener("click",(()=>{a(t.id,"published",c,n)}));const i=document.createElement("button");i.textContent="reject",i.addEventListener("click",(()=>{a(t.id,"draft",i,n)})),n.append(i),e.append(n)})),r.forEach((t=>{const e=o(t),a=document.createElement("button");a.textContent="delete",a.addEventListener("click",(()=>{c(t.id,a,e)})),e.append(a),n.append(e)})),d.forEach((t=>{const e=o(t),n=document.createElement("button");n.textContent="delete",n.addEventListener("click",(()=>{c(t.id,n,e)})),e.append(n),i.append(e)}))})).catch((t=>{console.log(t)}))})();
//# sourceMappingURL=publish.bundle.js.map